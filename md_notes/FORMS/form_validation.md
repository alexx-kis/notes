# Валидация

Валидация - это проверка на корректность данных, введённых пользователем

- под корректностью понимается соответствие данных требованиям валидации
- корректные данные не обязательно должны быть правильными

## Валидация формы

- атрибуты формы:

  - `method` - это способ отправки формы
    значения: `post`, `get` и другие
  - `action` .здесь значение - это адрес сервера, куда нужно отправить данные
  - `autocomplete="on/off"` (автозаполнение формы, если off, то браузер не будет запоминать данные)
  - `encrypt="multipart/form-data"` (он нужен для возможности отправки файлов из формы, а не только текста)

- у каждого input обязательно должен быть заполнен атрибут name, по которым серверу будет проще обрабатывать дынные
- атрибуты input:
  - `required` (обязательное поле)
  - `minlength="{number}"` (минимальная длина данных ввода)
  - `maxlength="{number}"` (максимальная длина данных ввода)

## PristineJS

- очень простая библиотека, используемая для валидации форм
  <a href="https://pristine.js.org/">https://pristine.js.org/</a>

- в модуле, который обеспечивает функциональность формы, создать новую валидацию

```js
// user-form.js:
const form = document.querySelector('.form');
const pristine = new Pristine(form, {
  classTo: 'img-upload__field-wrapper', // класс элемента-родителя поля валидации
  errorClass: 'img-upload__field-wrapper--invalid', // класс, который будет добавляться элементу-родителю в случае ошибки
  successClass: 'img-upload__field-wrapper--valid', // класс, который будет добавляться элементу-родителю в случае успеха
  errorTextParent: 'img-upload__field-wrapper', // класс элемента-родителя поля валидации, в который будет добавляться элемент-сообщение (тот же, что и первый)
  errorTextTag: 'div', // тег элемента-сообщения
  errorTextClass: 'img-upload__field-wrapper--error', // класс элемента-сообщения
});
```

- на `форму` добавить обработчик события `submit`

```js
form.addEventListener('submit', (evt) => {
  evt.preventDefault();

  const isValid = pristine.validate();

  if (isValid) {
    console.log('можно отправлять');
  } else {
    console.log('форма не валидна');
  }
});
```

- в функцию `Pristine` можно передать настройки (см. блок с кодом)

- в HTML нужно указать новые атрибуты и их значения, чтобы поменять тексты ошибок
- эти атрибуты задаются тегу `input`:

```html
data-pristine-required-message="обязательное поле"
data-pristine-minlength-message="Минимальная длина 2 символа"
data-pristine-maxlength-message="Максимальная длина 25 символов"
```

- чтобы описать валидации в JavaScript, нужно вызвать метод `.addValidator()`
- метод принимает несколько аргументов. Первый — элемент формы, который мы хотим валидировать

```js
const input = form.querySelector('#input');
pristine.addValidator(input, validate, 'От 2 до 50 символов');
```

- вторым аргументом в `.addValidator()` нужно передать функцию проверки. Можно передавать по месту, но удобнее объявить функцию выше и передать по ссылке

```js
function validate(value) {
  return value.length >= 2 && value.length <= 50;
}
```

- функция проверки обязательно должна возвращать `true` или `false`, в зависимости от того, валидно ли поле

- `Pristine` будет вызывать функцию проверки каждый раз, когда потребуется провалидировать форму. Первым параметром будет передано актуальное значение поля

- третьим аргументом нужно передать сообщение об ошибке

- если поле с именем пустое, или имя короче двух символов, или длиннее 50 символов — появится сообщение об ошибке
