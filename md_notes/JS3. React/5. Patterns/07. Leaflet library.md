# Leaflet library

- В этом примере мы создаем приложение с использованием React, которое отображает объекты на карте с помощью библиотеки Leaflet
- Рассмотрим процесс поэтапно.

## 1. Структура компонента

- Мы начинаем с создания компонента App, который будет включать список объектов и карту
- Пример объектов (точек на карте) хранится в массиве POINTS
- Для отображения объектов на странице используем два компонента: List и Map

## 2. Компонент List

- Компонент List принимает список объектов как пропсы и отображает их в виде списка.

```jsx
function List({ points }) {
  return (
    <ul className='list'>
      {points.map((point, index) => (
        <li className='list__item' key={index}>
          {point.title}
        </li>
      ))}
    </ul>
  );
}
```

## 3. Компонент Map

- Для отображения карты мы используем библиотеку Leaflet
- В компоненте Map создаем карту, используя данные из объекта CITY, который содержит информацию о координатах и масштабе карты

```jsx
import leaflet from 'leaflet';
import 'leaflet/dist/leaflet.css';

function Map({ city, points }) {
  const mapRef = useRef(null);

  useEffect(() => {
    const map = leaflet.map(mapRef.current, {
      center: [city.lat, city.lng],
      zoom: city.zoom,
    });

    leaflet
      .tileLayer(
        'https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png'
      )
      .addTo(map);

    points.forEach((point) => {
      leaflet.marker([point.lat, point.lng]).addTo(map);
    });
  }, [city, points]);

  return <div ref={mapRef} style={{ height: '500px' }}></div>;
}
```

## 4. Связь между компонентами

- В компонентах App и List добавляем функциональность для обработки событий наведения мыши на элементы списка
- Когда пользователь наводит курсор на название объекта в списке, соответствующий маркер на карте должен изменять свой стиль.

- Для этого в App создаем состояние selectedPoint, которое будет хранить текущий выбранный объект:

```jsx
function App() {
  const [selectedPoint, setSelectedPoint] = useState(null);

  const handleListItemHover = (point) => {
    setSelectedPoint(point);
  };

  return (
    <React.Fragment>
      <List points={POINTS} onListItemHover={handleListItemHover} />
      <Map city={CITY} points={POINTS} selectedPoint={selectedPoint} />
    </React.Fragment>
  );
}
```

- В компоненте List при наведении на элемент вызывается переданная функция onListItemHover, которая обновляет состояние в App:

```jsx
function List({ points, onListItemHover }) {
  return (
    <ul className='list'>
      {points.map((point, index) => (
        <li key={index} onMouseEnter={() => onListItemHover(point)}>
          {point.title}
        </li>
      ))}
    </ul>
  );
}
```

## 5. Отображение маркеров на карте

- Теперь, когда мы отслеживаем выбранный объект, в компоненте Map с помощью хука useEffect обновляем иконки маркеров
- Если маркер соответствует выбранному объекту, его иконка изменяется:

```jsx
function Map({ city, points, selectedPoint }) {
  const mapRef = useRef(null);

  useEffect(() => {
    const map = leaflet.map(mapRef.current, {
      center: [city.lat, city.lng],
      zoom: city.zoom,
    });

    leaflet
      .tileLayer(
        'https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png'
      )
      .addTo(map);

    points.forEach((point) => {
      leaflet
        .marker([point.lat, point.lng], {
          icon:
            point.title === selectedPoint?.title ? currentCustomIcon : defaultCustomIcon,
        })
        .addTo(map);
    });
  }, [city, points, selectedPoint]);

  return <div ref={mapRef} style={{ height: '500px' }}></div>;
}
```

- В результате, при наведении на элемент списка, на карте изменяется иконка маркера, соответствующего выбранному объекту

- Этот подход позволяет использовать React и Leaflet для создания интерактивной карты с данными, где каждый элемент списка связан с маркером на карте

=======================================================

## Yes, you can use Google Maps or Yandex Maps as base layers in Leaflet, but it requires some additional configuration since these services are not native to Leaflet. Below is an explanation and example for each:

## 1. Using Google Maps with Leaflet

- Google Maps can be integrated into Leaflet using a tile layer or an external plugin like `leaflet-plugins` or `Leaflet.GridLayer.GoogleMutant`.

### Steps:

- Obtain a Google Maps API key from the Google Cloud Platform.
- Use a plugin like Leaflet.GridLayer.GoogleMutant. This plugin allows you to add Google Maps as a tile layer while maintaining compatibility with Leaflet.

```javascript
import L from 'leaflet';
import 'leaflet.gridlayer.googlemutant';

const map = L.map('map').setView([37.7749, -122.4194], 13); // San Francisco example

// Add Google Maps base layer
const googleLayer = L.gridLayer.googleMutant({
  type: 'roadmap', // Options: roadmap, satellite, hybrid, terrain
});

googleLayer.addTo(map);
```

### Note:

- Be sure to comply with Google Maps' terms of service when integrating their tiles into Leaflet
- You'll need to include the Google Maps JavaScript API in your HTML

## 2. Using Yandex Maps with Leaflet

- To use Yandex Maps in Leaflet, you can use a plugin like `Leaflet.Yandex`
- It allows you to integrate Yandex tiles and services into your Leaflet map.

### Steps:

- Add the Leaflet.Yandex plugin to your project
- Yandex tiles can then be added as a layer using the plugin

```javascript
import L from 'leaflet';
import 'leaflet-yandex';

const map = L.map('map').setView([55.751244, 37.618423], 13); // Moscow example

// Add Yandex layer
const yandexLayer = new L.Yandex();
map.addLayer(yandexLayer);
```

### Yandex Tile Types:

- Default: Standard Yandex map
- Satellite: Yandex satellite imagery
- Hybrid: Combination of satellite and labels

### Things to Keep in Mind

- API Key Requirements:

  - Google Maps always requires an API key for integration
  - Yandex Maps might not require an API key for simple usage, but advanced features often do

- License Restrictions: Both Google and Yandex have strict terms of service about how you can use their maps, especially for commercial applications

- Plugins Maintenance: Some plugins might not be actively maintained, so ensure compatibility with your Leaflet version
